@startuml
actor Administrador

participant "cu: ControladorUsuario" as CU
participant "cdu: <Singleton> CatálogoDeUsuarios" as CatU
participant "usr[i]: Usuario" as U

== Registro de usuario ==
Administrador -> CU : registrar_usuario(usuario_id, datos)
activate CU

CU -> CatU : buscar_usuario(usuario_id)
activate CatU

loop para cada usuario en CatálogoDeUsuarios
    note right of CatU
        Se verifica si el usuario_id ya existe
        comparando con los del catálogo
        para evitar duplicados.
    end note
    CatU -> U : getId()
    activate U
    U --> CatU : <<id : usuario_id>>
    deactivate U
end

CatU --> CU : <<usuario_encontrado (boolean)>>
deactivate CatU

alt Usuario no encontrado
    CU -> CatU : agregar_usuario(usuario_id, datos)
    activate CatU
    CatU --> CU : <<confirmación registro (boolean = true), usuario_id>>
    deactivate CatU
    CU --> Administrador : <<confirmación registro (boolean = true), usuario_id>>
else Usuario ya existente
    CU --> Administrador : <<mensaje de error("El usuario ya está registrado")>>
end

deactivate CU
@enduml
