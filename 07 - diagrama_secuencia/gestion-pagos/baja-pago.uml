@startuml
actor Usuario

participant "cp: ControladorPago" as P
participant "ci: <Singleton> CatálogoDeInscripciones" as CatI
participant "insc[i]: Inscripción" as Ins
participant "pago: Pago" as Pago

== Baja de pago ==
Usuario -> P : solicitar_baja_pago(pago_id)
activate P

P -> CatI : buscar_inscripcion(pago_id)
activate CatI

loop para cada inscripción en CatálogoDeInscripciones
    CatI -> Ins : getPagoId()
    activate Ins
    Ins --> CatI : <<id : pago_id>>
      note right of CatI
        Si id = pago_id  
        inscripción = insc[i]  
        cortar iteración
      end note
    deactivate Ins
end

CatI --> P : <<pago:Pago>>
deactivate CatI

alt Inscripción válida
    P -> Usuario : solicitar_confirmacion()
    Usuario -> P : aceptar_confirmacion()

    alt Confirmación aceptada
        P -> Pago : marcar_como_inhabilitado(pago_id)
        activate Pago
        Pago --> P : <<confirmación baja (boolean)>>
        deactivate Pago
        P --> Usuario : <<confirmación baja (boolean = true)>>
    else Cancelación por el usuario
        P --> Usuario : <<mensaje("Acción cancelada por el usuario")>>
    end

else Inscripción no encontrada / inválida
    P --> Usuario : <<mensaje de error("No se encontró una inscripción asociada al pago")>>
end

deactivate P
@enduml

